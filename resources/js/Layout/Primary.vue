<script setup lang="ts">
import type { User } from '@/types/user';
import { usePage } from '@inertiajs/vue3';
import { ref } from 'vue';
import { computed } from 'vue';

const user = usePage().props.authUser as User || null;

const userNameFirstCharacters = computed(() => {
    return user?.name.split(" ").map(e => e[0]).join("")
})

const userModelOpen = ref(false)
</script>

<template>
    <div class="container flex flex-col h-screen mx-auto text-dark">
        <header class="flex items-center justify-between p-2">
            <A href="/" class="flex items-center gap-2">
                <svg class="w-8 h-8" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_6_2)">
                        <path
                            d="M409.6 0H102.4C45.846 0 0 45.846 0 102.4V409.6C0 466.154 45.846 512 102.4 512H409.6C466.154 512 512 466.154 512 409.6V102.4C512 45.846 466.154 0 409.6 0Z"
                            fill="#264653" />
                        <path
                            d="M172.204 367.9C171.821 366.943 171.63 363.498 171.63 357.564C171.63 351.631 171.63 344.166 171.63 335.17C171.821 326.174 172.013 316.125 172.204 305.023C172.587 293.73 172.874 282.342 173.065 270.857C173.448 259.182 173.831 247.889 174.214 236.979C174.597 225.877 174.884 216.02 175.075 207.406C175.458 198.793 175.745 191.807 175.937 186.447C176.128 180.896 176.319 177.93 176.511 177.547C176.702 176.781 177.563 174.867 179.095 171.805C180.626 168.742 182.349 165.584 184.263 162.33C186.368 158.885 188.474 155.918 190.579 153.43C192.685 150.75 194.503 149.506 196.034 149.697C196.608 149.889 197.087 153.717 197.47 161.182C198.044 168.455 198.522 177.834 198.905 189.318C199.479 200.803 199.862 213.531 200.054 227.504C200.437 241.285 200.724 254.779 200.915 267.986C201.298 281.002 201.585 292.869 201.776 303.588C201.968 314.115 202.159 321.867 202.351 326.844C208.476 327.418 214.601 327.896 220.726 328.279C227.042 328.662 232.688 329.141 237.665 329.715C242.642 330.098 246.661 330.48 249.724 330.863C252.978 331.246 254.7 331.533 254.892 331.725C255.466 332.49 256.231 334.309 257.188 337.18C258.337 339.859 259.39 342.826 260.347 346.08C261.304 349.143 261.974 352.014 262.356 354.693C262.931 357.373 262.835 359 262.069 359.574C240.058 363.594 223.022 366.273 210.964 367.613C198.905 368.953 190.005 369.623 184.263 369.623C177.563 369.623 173.544 369.049 172.204 367.9ZM361.983 185.299C362.175 188.17 361.792 192.477 360.835 198.219C360.069 203.961 358.729 209.703 356.815 215.445C354.901 221.188 352.413 226.26 349.351 230.662C346.479 234.873 343.13 236.979 339.302 236.979C337.388 236.979 335.761 235.83 334.421 233.533C333.081 231.236 331.933 228.27 330.976 224.633C330.019 220.996 329.253 216.977 328.679 212.574C328.104 207.98 327.53 203.578 326.956 199.367C326.573 195.156 326.19 191.328 325.808 187.883C325.616 184.246 325.425 181.566 325.233 179.844C324.468 178.695 323.032 177.547 320.927 176.398C319.013 175.059 317.29 174.389 315.759 174.389C314.036 174.389 311.931 176.016 309.442 179.27C307.146 182.523 304.944 186.352 302.839 190.754C300.733 195.156 299.011 199.559 297.671 203.961C296.331 208.172 295.757 211.426 295.948 213.723C295.948 215.254 297.384 217.934 300.255 221.762C303.317 225.59 307.05 230.088 311.452 235.256C315.854 240.424 320.64 246.07 325.808 252.195C330.976 258.129 335.761 264.062 340.163 269.996C344.565 275.93 348.298 281.576 351.36 286.936C354.423 292.295 356.05 296.889 356.241 300.717C356.624 305.311 355.571 311.244 353.083 318.518C350.786 325.6 347.819 332.49 344.183 339.189C340.546 345.889 336.622 351.727 332.411 356.703C328.392 361.488 324.755 363.977 321.501 364.168C319.396 364.359 316.62 363.402 313.175 361.297C309.729 359.383 305.997 356.799 301.978 353.545C297.958 350.291 293.843 346.75 289.632 342.922C285.612 338.902 281.784 334.979 278.147 331.15C274.702 327.322 271.735 323.877 269.247 320.814C266.95 317.561 265.61 315.168 265.228 313.637C264.462 311.34 263.983 308.277 263.792 304.449C263.792 300.43 263.983 296.602 264.366 292.965C264.94 289.137 265.61 285.883 266.376 283.203C267.333 280.332 268.481 278.896 269.821 278.896C270.778 278.896 272.31 280.141 274.415 282.629C276.712 285.117 279.296 288.275 282.167 292.104C285.038 295.932 288.101 300.143 291.354 304.736C294.8 309.139 298.054 313.254 301.116 317.082C304.179 320.91 306.954 324.164 309.442 326.844C311.931 329.332 313.94 330.48 315.472 330.289C316.62 330.289 317.864 329.428 319.204 327.705C320.544 325.791 321.788 323.59 322.937 321.102C324.085 318.422 325.042 315.742 325.808 313.062C326.573 310.383 326.956 308.277 326.956 306.746C326.765 304.449 324.851 301.195 321.214 296.984C317.769 292.582 313.366 287.701 308.007 282.342C302.839 276.791 297.192 271.049 291.067 265.115C285.134 259.182 279.487 253.535 274.128 248.176C268.96 242.625 264.558 237.648 260.921 233.246C257.476 228.844 255.657 225.494 255.466 223.197C255.274 220.9 255.944 217.359 257.476 212.574C259.007 207.598 261.017 202.047 263.505 195.922C266.185 189.797 269.151 183.576 272.405 177.26C275.659 170.943 279.009 165.105 282.454 159.746C285.899 154.387 289.249 150.08 292.503 146.826C295.757 143.381 298.628 141.658 301.116 141.658C304.37 141.658 308.103 142.424 312.313 143.955C316.524 145.295 320.831 147.209 325.233 149.697C329.827 151.994 334.229 154.674 338.44 157.736C342.843 160.799 346.767 163.957 350.212 167.211C353.657 170.273 356.433 173.432 358.538 176.686C360.644 179.748 361.792 182.619 361.983 185.299Z"
                            fill="white" />
                    </g>
                    <defs>
                        <clipPath id="clip0_6_2">
                            <rect width="512" height="512" fill="white" />
                        </clipPath>
                    </defs>
                </svg>
                <div class="text-lg font-bold">
                    Link Shortener
                </div>
            </A>

            <div class="relative">
                <div @click="userModelOpen = true" role="button" class="flex items-center gap-2 text-sm opacity-100 ">
                    <strong class="block">
                        {{ user?.name }}
                    </strong>
                    <div class="p-2 font-bold text-white uppercase rounded-full bg-dark/80">
                        {{ userNameFirstCharacters }}
                    </div>
                </div>
                <div v-if="userModelOpen"
                    class="absolute top-0 right-0 flex flex-col gap-1 p-2 bg-white rounded-md shadow-lg w-60">
                    <div class="flex items-center gap-2">
                        <div class="grid place-content-center">
                            <div class="p-2 text-xl font-bold text-white uppercase rounded-full bg-dark/80">
                                {{ userNameFirstCharacters }}
                            </div>
                        </div>
                        <div class="flex-1">
                            <strong class="block">
                                {{ user?.name }}
                            </strong>
                            <small>
                                {{ user?.email }}
                            </small>
                        </div>
                        <A :href="route('logout')" method="delete" replace as="button">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="w-5 h-5" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z" />
                                <path fill-rule="evenodd"
                                    d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z" />
                            </svg>
                        </A>
                    </div>
                </div>
            </div>
        </header>

        <main class="flex-1">
            <slot />
        </main>
    </div>
</template>
